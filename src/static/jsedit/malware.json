{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "title": "malware",
    "description": "Malware is a type of TTP that is also known as malicious code and malicious software, refers to a program that is inserted into a system, usually covertly, with the intent of compromising the confidentiality, integrity, or availability of the victim's data, applications, or operating system (OS) or of otherwise annoying or disrupting the victim.",
    "type": "object",
    "$ref": "static/jsedit/core.json",
    "properties": {
        "id": {
            "type": "string",
            "title": "id",
            "pattern": "^malware--",
            "default": "malware--",
            "readonly": "true"
        },
        "type": {
            "type": "string",
            "description": "The type of this object, which MUST be the literal `malware`.",
            "default": "malware",
            "readonly": "true"
        },
        "name": {
            "type": "string",
            "description": "The name used to identify the Malware."
        },
        "description": {
            "type": "string",
            "format": "textarea",
            "description": "Provides more context and details about the Malware object."
        },
        "malware_types": {
            "type": "array",
            "description": "The values for this property SHOULD come from the malware-type-ov open vocabulary.",
            "items": {
                "type": "string",
                "$ref": "#/definitions/malware-type-ov"
            },
            "minItems": 1
        },
        "is_family": {
            "type": "boolean",
            "description": "Whether the object represents a malware family (if true) or a malware instance (if false).",
            "enum": [
                false,
                true
            ]
        },
        "aliases": {
            "type": "array",
            "description": "Alternative names used to identify this malware or malware family.",
            "items": {
                "type": "string"
            },
            "minItems": 1
        },
        "kill_chain_phases": {
            "type": "array",
            "description": "The list of Kill Chain Phases for which this malware can be used.",
            "$ref": "static/jsedit/kill-chain-phase.json",
            "minItems": 1
        },
        "first_seen": {
            "$ref": "static/jsedit/common/timestamp.json",
            "description": "The time that the malware instance or family was first seen."
        },
        "last_seen": {
            "$ref": "static/jsedit/common/timestamp.json",
            "description": "The time that the malware family or malware instance was last seen."
        },
        "operating_system_refs": {
            "type": "array",
            "description": "The operating systems that the malware family or malware instance is executable on. This applies to virtualized operating systems as well as those running on bare metal. The value of this property MUST be the identifier for a SCO software object.",
            "items": {
                "$ref": "static/jsedit/common/identifier.json"
            },
            "minItems": 1
        },
        "architecture_execution_envs": {
            "type": "array",
            "description": "The processor architectures (e.g., x86, ARM, etc.) that the malware instance or family is executable on.",
            "items": {
                "$ref": "#/definitions/processor-architecture-ov"
            },
            "minItems": 1
        },
        "implementation_languages": {
            "type": "array",
            "description": "The programming language(s) used to implement the malware instance or family.",
            "items": {
                "$ref": "#/definitions/implementation-language-ov"
            },
            "minItems": 1
        },
        "capabilites": {
            "type": "array",
            "description": "Specifies any capabilities identified for the malware instance or family.",
            "items": {
                "$ref": "#/definitions/malware-capabilities-ov"
            },
            "minItems": 1
        },
        "sample_refs": {
            "type": "array",
            "description": "The sample_refs property specifies a list of identifiers of the SCO file or artifact objects associated with this malware instance(s) or family.",
            "items": {
                "$ref": "static/jsedit/common/identifier.json"
            },
            "minItems": 1
        }
    },
    "required": [
        "is_family"
    ],
    "definitions": {
        "malware-type-ov": {
            "type": "string",
            "enum": [
                "adware",
                "backdoor",
                "bot",
                "bootkit",
                "ddos",
                "downloader",
                "dropper",
                "exploit-kit",
                "keylogger",
                "ransomware",
                "remote-access-trojan",
                "resource-exploitation",
                "rogue-security-software",
                "rootkit",
                "screen-capture",
                "spyware",
                "trojan",
                "unknown",
                "virus",
                "webshell",
                "wiper",
                "worm"
            ]
        },
        "implementation-language-ov": {
            "type": "string",
            "enum": [
                "applescript",
                "bash",
                "c",
                "c++",
                "c#",
                "go",
                "java",
                "javascript",
                "lua",
                "objective-c",
                "perl",
                "php",
                "powershell",
                "python",
                "ruby",
                "scala",
                "swift",
                "typescript",
                "visual-basic",
                "x86-32",
                "x86-64"
            ]
        },
        "malware-capabilities-ov": {
            "type": "string",
            "enum": [
                "accesses-remote-machines",
                "anti-debugging",
                "anti-disassembly",
                "anti-emulation",
                "anti-memory-forensics",
                "anti-sandbox",
                "anti-vm",
                "captures-input-peripherals",
                "captures-output-peripherals",
                "captures-system-state-data",
                "cleans-traces-of-infection",
                "commits-fraud",
                "communicates-with-c2",
                "compromises-data-availability",
                "compromises-data-integrity",
                "compromises-system-availability",
                "controls-local-machine",
                "degrades-security-software",
                "degrades-system-updates",
                "determines-c2-server",
                "emails-spam",
                "escalates-privileges",
                "evades-av",
                "exfiltrates-data",
                "fingerprints-host",
                "hides-artifacts",
                "hides-executing-code",
                "infects-files",
                "infects-remote-machines",
                "installs-other-components",
                "persists-after-system-reboot",
                "prevents-artifact-access",
                "prevents-artifact-deletion",
                "probes-network-environment",
                "self-modifies",
                "steals-authentication-credentials",
                "violates-system-operational-integrity"
            ]
        },
        "processor-architecture-ov": {
            "type": "string",
            "enum": [
                "alpha",
                "arm",
                "ia-64",
                "mips",
                "powerpc",
                "sparc",
                "x86",
                "x86-64"
            ]
        }
    }
}
